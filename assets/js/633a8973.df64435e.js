"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[663],{3905:(e,n,t)=>{t.d(n,{Zo:()=>m,kt:()=>k});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function a(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},l=Object.keys(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var i=r.createContext({}),p=function(e){var n=r.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},m=function(e){var n=p(e.components);return r.createElement(i.Provider,{value:n},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,l=e.originalType,i=e.parentName,m=a(e,["components","mdxType","originalType","parentName"]),c=p(t),d=o,k=c["".concat(i,".").concat(d)]||c[d]||u[d]||l;return t?r.createElement(k,s(s({ref:n},m),{},{components:t})):r.createElement(k,s({ref:n},m))}));function k(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var l=t.length,s=new Array(l);s[0]=d;var a={};for(var i in n)hasOwnProperty.call(n,i)&&(a[i]=n[i]);a.originalType=e,a[c]="string"==typeof e?e:o,s[1]=a;for(var p=2;p<l;p++)s[p]=t[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},8700:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>s,default:()=>u,frontMatter:()=>l,metadata:()=>a,toc:()=>p});var r=t(7462),o=(t(7294),t(3905));const l={},s="Promise",a={unversionedId:"Javascript/Promise",id:"Javascript/Promise",title:"Promise",description:"\u4e3a\u4ec0\u4e48\u4f1a\u6709Promise",source:"@site/docs/Javascript/Promise.md",sourceDirName:"Javascript",slug:"/Javascript/Promise",permalink:"/docs/Javascript/Promise",draft:!1,editUrl:"https://github.com/suilang/fe-started-to-buried/blob/docusaurus/docs/Javascript/Promise.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u4e8b\u4ef6\u673a\u5236/EventLoop",permalink:"/docs/Javascript/shi-jian-ji-zhi"},next:{title:"\u9632\u6296\u548c\u8282\u6d41",permalink:"/docs/Javascript/debounce-throttle"}},i={},p=[{value:"\u4e3a\u4ec0\u4e48\u4f1a\u6709Promise",id:"\u4e3a\u4ec0\u4e48\u4f1a\u6709promise",level:2},{value:"\u8ba4\u8bc6Promise",id:"\u8ba4\u8bc6promise",level:2},{value:"\u4e3a\u4ec0\u4e48\u8981\u5f15\u5165\u5fae\u4efb\u52a1",id:"\u4e3a\u4ec0\u4e48\u8981\u5f15\u5165\u5fae\u4efb\u52a1",level:3},{value:"\u624b\u5199Promise",id:"\u624b\u5199promise",level:2},{value:"promise\u89c4\u8303",id:"promise\u89c4\u8303",level:3},{value:"\u5b9e\u73b0then\u548ccatch",id:"\u5b9e\u73b0then\u548ccatch",level:3},{value:"\u5b9e\u73b0Resolve",id:"\u5b9e\u73b0resolve",level:3},{value:"\u5b9e\u73b0Reject",id:"\u5b9e\u73b0reject",level:3},{value:"\u5b9e\u73b0Finall",id:"\u5b9e\u73b0finall",level:3},{value:"\u5b9e\u73b0all",id:"\u5b9e\u73b0all",level:3},{value:"\u5b9e\u73b0race",id:"\u5b9e\u73b0race",level:3},{value:"\u5173\u8054\u95ee\u9898",id:"\u5173\u8054\u95ee\u9898",level:2},{value:"\u8865\u5145\u77e5\u8bc6",id:"\u8865\u5145\u77e5\u8bc6",level:2},{value:"Promise/A+ \u89c4\u8303",id:"promisea-\u89c4\u8303",level:3},{value:"\u8bbe\u8ba1\u6a21\u5f0f",id:"\u8bbe\u8ba1\u6a21\u5f0f",level:3},{value:"Promise\u548casync\u7684\u5dee\u5f02\u70b9",id:"promise\u548casync\u7684\u5dee\u5f02\u70b9",level:3},{value:"\u53c2\u8003\u6587\u6863",id:"\u53c2\u8003\u6587\u6863",level:2},{value:"\u793a\u4f8b\u4ee3\u7801",id:"\u793a\u4f8b\u4ee3\u7801",level:2}],m={toc:p},c="wrapper";function u(e){let{components:n,...t}=e;return(0,o.kt)(c,(0,r.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"promise"},"Promise"),(0,o.kt)("h2",{id:"\u4e3a\u4ec0\u4e48\u4f1a\u6709promise"},"\u4e3a\u4ec0\u4e48\u4f1a\u6709Promise"),(0,o.kt)("p",null,"\u5728\u8ba4\u8bc6",(0,o.kt)("inlineCode",{parentName:"p"},"Promise"),"\u4e4b\u524d\uff0c\u6709\u5fc5\u8981\u77e5\u9053\u4ec0\u4e48\u662f ",(0,o.kt)("strong",{parentName:"p"},"\u56de\u8c03\u5730\u72f1"),"\uff08Callback Hell\uff09\u3002"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u65e0\u963b\u585e\u9ad8\u5e76\u53d1\uff0c\u662fnodeJS\u7684\u62db\u724c\uff0c\u8981\u8fbe\u5230\u65e0\u963b\u585e\u9ad8\u5e76\u53d1\uff0c\u5f02\u6b65\u662f\u5176\u57fa\u672c\u4fdd\u969c"),"\u3002\u4e4b\u524d\u5904\u7406\u5f02\u6b65\u662f\u901a\u8fc7\u7eaf\u7cb9\u7684\u56de\u8c03\u51fd\u6570\uff0c\u4f8b\u5982\uff0c\u4f7f\u7528ajax\u53d1\u8d77\u5f02\u6b65\u8bf7\u6c42\uff0c\u7136\u540e\u4f7f\u7528\u56de\u8c03\u51fd\u6570\u6765\u5904\u7406\u8fd4\u56de\u7ed3\u679c\u3002"),(0,o.kt)("p",null,"\u5982\u679c\u53ea\u6709\u4e00\u6b21\u56de\u8c03\uff0c\u4e5f\u6ca1\u4ec0\u4e48\u95ee\u9898\u3002\u4f46\u662f\uff0c\u5982\u679c\u6211\u4eec\u8981\u7528\u7b2c\u4e00\u6b21\u5f02\u6b65\u8fd4\u56de\u7684\u7ed3\u679c\u6765\u51b3\u5b9a\u7b2c\u4e8c\u6b21\u5f02\u6b65\u8bf7\u6c42\uff0c\u7528\u7b2c\u4e8c\u6b21\u5f02\u6b65\u8bf7\u6c42\u7684\u7ed3\u679c\u6765\u51b3\u5b9a\u7b2c\u4e09\u6b21\u5f02\u6b65\u8bf7\u6c42\uff0c\u5c42\u5c42\u5d4c\u5957\u4e0b\u53bb\uff0c\u5c31\u5f62\u6210\u4e86\u6240\u8c13\u7684",(0,o.kt)("strong",{parentName:"p"},"\u56de\u8c03\u5730\u72f1"),"\u3002"),(0,o.kt)("p",null,"\u4e3e\u4e2a\u4f8b\u5b50"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"function loadImg(src,cb){\n      const img = new Img();\n      img.src = src \n      img.onload=()=>{cb()}\n      img.onerror=()=>{cb(new Error('failed to load '+src ))  }\n  }\nloadImg('img1', err=>{\n  if(err===undefined) {\n      f1(); \n  } else {\n      console.log(err.message);\n  }\n})\n")),(0,o.kt)("p",null,"\u5355\u4e00\u7684\u5904\u7406\u903b\u8f91\uff0c\u975e\u5e38\u597d\u5904\u7406\uff0c\u4f46\u5982\u679c\u518d\u8865\u4e0a\u4e24\u5c42\u903b\u8f91"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"}," loadImg('img1', err=>{\n     if(err===undefined) {\n         f1();\n         loadImg('img2', err=>{\n             if(err===undefined) {\n                 f2();\n                 loadImg('img3', err=>{\n                     if(err===undefined) {\n                         f3();\n                     } else {\n                         console.log(err.message);\n                     }\n                 })\n             } else {\n                 console.log(err.message);\n             }\n         })\n     } else {\n         console.log(err.message);\n     }\n })\n")),(0,o.kt)("p",null,"\u6bcf\u591a\u4e00\u5c42\u56de\u8c03\uff0c\u5c31\u4f1a\u8865\u4e24\u5c42\u5224\u65ad\uff0c\u6700\u7ec8\uff0c\u95ee\u9898\u53ef\u4ee5\u89e3\u51b3\uff0c\u4f46\u662f\u96be\u4ee5\u8bfb\u61c2\uff0c\u5e76\u4e14\u4e0d\u597d\u7ef4\u62a4\u3002"),(0,o.kt)("p",null,"\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c",(0,o.kt)("inlineCode",{parentName:"p"},"Promise"),"\u4fbf\u5e94\u8fd0\u800c\u751f\u2014\u2014\u4e3b\u8981\u662f\u5c06",(0,o.kt)("strong",{parentName:"p"},"\u6df1\u5c42\u56de\u8c03"),"\u53d8\u6210\u4e86",(0,o.kt)("strong",{parentName:"p"},"\u94fe\u5f0f\u8c03\u7528"),"\uff0c\u8fd9\u6837\u80fd\u66f4\u7b26\u5408\u4eba\u7c7b\u903b\u8f91\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"}," function loadImg(src){\n     const img = new Img();\n      img.src = src \n      return new Promise((resolve, reject)=>{\n          img.onload=()=>{resolve('success '+ src)}\n          img.onerror=()=>{reject(new Error('failed to load '+src ))  }\n      })\n  }\n")),(0,o.kt)("p",null,"\u5c06\u5d4c\u5957\u56de\u8c03\u6539\u4e3a\u94fe\u5f0f\u8c03\u7528"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"loadImg('img1')\n     .then(str=>{\n         console.log(str);\n         f1();\n         return loadImg('img2')   //\u8fd9\u91cc\u8fd4\u56de\u4e00\u4e2aPromise\n     })                           // \u76f4\u63a5\u5c31\u80fd\u7528 then\n     .then(str=>{\n         console.log(str);\n         f2();\n         return loadImg('img3')     // \u518d\u8fd4\u56de\u4e00\u4e2aPromise\n     })\n     .then(str=>{           \n         console.log(str);\n         f3();\n     })\n     .catch(er=>{\n         console.log(er.message);\n     })\n")),(0,o.kt)("p",null,"\u6574\u4e2a\u903b\u8f91\u5c31\u5f88\u660e\u6670\u548c\u6e05\u723d\u4e86\u3002"),(0,o.kt)("h2",{id:"\u8ba4\u8bc6promise"},"\u8ba4\u8bc6Promise"),(0,o.kt)("p",null,"MDN \u4e0a\u5bf9Promise\u6982\u5ff5\u7684\u63cf\u8ff0\u4e3a\uff1a"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Promise \u5bf9\u8c61\u662f\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61\uff08\u4ee3\u7406\u4e00\u4e2a\u503c\uff09\uff0c\u88ab\u4ee3\u7406\u7684\u503c\u5728Promise\u5bf9\u8c61\u521b\u5efa\u65f6\u53ef\u80fd\u662f\u672a\u77e5\u7684\u3002\u5b83\u5141\u8bb8\u4f60\u4e3a\u5f02\u6b65\u64cd\u4f5c\u7684\u6210\u529f\u548c\u5931\u8d25\u5206\u522b\u7ed1\u5b9a\u76f8\u5e94\u7684\u5904\u7406\u65b9\u6cd5\u3002 \u8fd9\u8ba9\u5f02\u6b65\u65b9\u6cd5\u53ef\u4ee5\u50cf\u540c\u6b65\u65b9\u6cd5\u90a3\u6837\u8fd4\u56de\u503c\uff0c\u4f46\u5e76\u4e0d\u662f\u7acb\u5373\u8fd4\u56de\u6700\u7ec8\u6267\u884c\u7ed3\u679c\uff0c\u800c\u662f\u4e00\u4e2a\u80fd\u4ee3\u8868\u672a\u6765\u51fa\u73b0\u7684\u7ed3\u679c\u7684promise\u5bf9\u8c61")),(0,o.kt)("p",null,"Promise\u7684\u6838\u5fc3\u662f",(0,o.kt)("strong",{parentName:"p"},"\u5f02\u6b65\u94fe\u5f0f\u8c03\u7528"),"\u3002\u5b83\u5229\u7528\u4e86\u4e09\u5927\u6280\u672f\u624b\u6bb5\u6765\u89e3\u51b3\u56de\u8c03\u5730\u72f1:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u56de\u8c03\u51fd\u6570\u5ef6\u8fdf\u7ed1\u5b9a\u3002"),(0,o.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u503c\u7a7f\u900f\u3002"),(0,o.kt)("li",{parentName:"ul"},"\u9519\u8bef\u5192\u6ce1\u3002")),(0,o.kt)("p",null,"\u8fd8\u662f\u4e0a\u9762\u7684\u4f8b\u5b50\uff0c\u56de\u8c03\u51fd\u6570\u4e0d\u662f\u76f4\u63a5\u58f0\u660e\u7684\uff0c\u800c\u662f\u5728\u901a\u8fc7\u540e\u9762\u7684 then \u65b9\u6cd5\u4f20\u5165\u7684\uff0c\u5373\u5ef6\u8fdf\u4f20\u5165\u3002\u8fd9\u5c31\u662f",(0,o.kt)("strong",{parentName:"p"},"\u56de\u8c03\u51fd\u6570\u5ef6\u8fdf\u7ed1\u5b9a"),"\u3002"),(0,o.kt)("p",null,"\u6839\u636e then \u4e2d\u56de\u8c03\u51fd\u6570\u7684\u4f20\u5165\u503c\u521b\u5efa\u4e0d\u540c\u7c7b\u578b\u7684Promise, \u7136\u540e\u628a\u8fd4\u56de\u7684 Promise \u7a7f\u900f\u5230\u5916\u5c42, \u4ee5\u4f9b\u540e\u7eed\u7684\u8c03\u7528\u3002\u8fd9\u4fbf\u662f",(0,o.kt)("strong",{parentName:"p"},"\u8fd4\u56de\u503c\u7a7f\u900f"),"\u3002\u540c\u56de\u8c03\u51fd\u6570\u5ef6\u8fdf\u7ed1\u5b9a\u4e00\u8d77\uff0c\u5f62\u6210\u4e86\u94fe\u5f0f\u8c03\u7528\u7684\u6548\u679c\u3002"),(0,o.kt)("p",null,"\u5728\u6574\u4e2a\u94fe\u5f0f\u8c03\u7528\u6d41\u7a0b\u4e2d\uff0c\u67d0\u4e2a\u6d41\u7a0b\u4e00\u65e6\u62a5\u9519\uff0c\u4ea7\u751f\u7684\u9519\u8bef\u4f1a\u4e00\u76f4\u5411\u540e\u4f20\u9012\uff0c\u88ab\u6700\u540e\u7684catch \u63a5\u6536\u5230\u3002\u8fd9\u5c31\u662f",(0,o.kt)("strong",{parentName:"p"},"\u9519\u8bef\u5192\u6ce1"),"\u3002"),(0,o.kt)("h3",{id:"\u4e3a\u4ec0\u4e48\u8981\u5f15\u5165\u5fae\u4efb\u52a1"},"\u4e3a\u4ec0\u4e48\u8981\u5f15\u5165\u5fae\u4efb\u52a1"),(0,o.kt)("p",null,"Promise \u4e2d\u7684\u6267\u884c\u51fd\u6570\u662f\u540c\u6b65\u8fdb\u884c\u7684\uff0c\u4f46\u662f\u91cc\u9762\u5b58\u5728\u7740\u5f02\u6b65\u64cd\u4f5c\uff0c\u5728\u5f02\u6b65\u64cd\u4f5c\u7ed3\u675f\u540e\u4f1a\u8c03\u7528 resolve \u65b9\u6cd5\uff0c\u6216\u8005\u4e2d\u9014\u9047\u5230\u9519\u8bef\u8c03\u7528 reject \u65b9\u6cd5\uff0c\u8fd9\u4e24\u8005\u90fd\u662f\u4f5c\u4e3a\u5fae\u4efb\u52a1\u8fdb\u5165\u5230 EventLoop \u4e2d\u3002"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u91c7\u7528\u540c\u6b65\u8c03\u7528\uff1f"),"\n\u540c\u6b65\u8c03\u7528\u4f1a\u8ba9\u6574\u4e2a\u811a\u672c\u963b\u585e\u4f4f\uff0c\u5f53\u524d\u4efb\u52a1\u7b49\u5f85\uff0c\u540e\u9762\u7684\u4efb\u52a1\u90fd\u65e0\u6cd5\u5f97\u5230\u6267\u884c\uff0c\u5e76\u4e14\u65e0\u6cd5\u5b9e\u73b0\u5ef6\u8fdf\u7ed1\u5b9a\u7684\u6548\u679c\u3002"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u4f5c\u4e3a\u5b8f\u4efb\u52a1\u5f02\u6b65\u8c03\u7528\uff1f")),(0,o.kt)("p",null,"\u5728\u6d4f\u89c8\u5668\u4e2d\uff0c\u5b8f\u4efb\u52a1\u4e0e\u5fae\u4efb\u52a1\u662f\u4ea4\u66ff\u6267\u884c\u7684\uff0c\u7b80\u5355\u6765\u8bf4\uff0c\u6267\u884c\u5b8c\u4e00\u4e2a\u5b8f\u4efb\u52a1\uff0c\u5c31\u4f1a\u63a5\u7740\u6267\u884c\u6574\u4e2a\u5fae\u4efb\u52a1\u5217\u8868\u4e2d\u7684 \u4efb\u52a1\uff0c\u7136\u540e\u518d\u6267\u884c\u4e00\u4e2a\u5b8f\u4efb\u52a1\u3002"),(0,o.kt)("p",null,"\u56de\u8c03\u4f5c\u4e3a\u5b8f\u4efb\u52a1\u6267\u884c\uff0c\u4f1a\u88ab\u653e\u5230\u5f53\u524d\u5b8f\u4efb\u52a1\u961f\u5c3e\u3002\u5982\u679c\u5f53\u524d\u5b8f\u4efb\u52a1\u961f\u5217\u8fc7\u957f\uff0c\u6bcf\u4e2a\u5b8f\u4efb\u52a1\u91cc\u53c8\u521b\u5efa\u4e86\u5bf9\u5e94\u7684\u5fae\u4efb\u52a1\u3002\u5f53\u90a3\u4e48\u56de\u8c03\u8fdf\u8fdf\u5f97\u4e0d\u5230\u6267\u884c\uff0c\u5c31\u4f1a\u9020\u6210\u5e94\u7528\u5361\u987f\u3002"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u4f5c\u4e3a\u5fae\u4efb\u52a1\u5f02\u6b65\u8c03\u7528")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"resolve"),"\u6216",(0,o.kt)("inlineCode",{parentName:"p"},"reject")," \u65b9\u6cd5\u4f1a\u653e\u5728\u5fae\u4efb\u52a1\u961f\u5217\u7684\u961f\u5c3e\uff0c\u7b49\u672c\u6b21\u5b8f\u4efb\u52a1\u6267\u884c\u5b8c\u6210\uff0c\u6d4f\u89c8\u5668\u5c31\u4f1a\u4f9d\u6b21\u5904\u7406\u5fae\u4efb\u52a1\u76f4\u5230\u6e05\u7a7a\u5fae\u4efb\u52a1\u961f\u5217\u3002\u8fd9\u6837\uff0c\u5373\u4e0d\u4f1a\u5f71\u54cd\u5ef6\u8fdf\u7ed1\u5b9a\uff0c\u53c8\u4e0d\u4f1a\u7531\u4e8e\u7b49\u5f85\u65f6\u95f4\u592a\u957f\u9020\u6210\u5e94\u7528\u5361\u987f\u3002"),(0,o.kt)("h2",{id:"\u624b\u5199promise"},"\u624b\u5199Promise"),(0,o.kt)("p",null,"\u4e0d\u7ba1\u600e\u4e48\u5b9e\u73b0\uff0c\u53ea\u8981\u9075\u5faapromise a+ \u89c4\u8303 \uff0c\u90a3\u5c31\u662f\u4e00\u4e2aPromise\u7c7b\u3002"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u8be5\u5b9e\u4f8b\u5b8c\u6574\u4ee3\u7801\u9644\u5728\u6587\u7ae0\u672b\u5c3e")),(0,o.kt)("h3",{id:"promise\u89c4\u8303"},"promise\u89c4\u8303"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"Promise"),"\u662f\u4e00\u4e2a\u7c7b, \u7c7b\u4e2d\u9700\u8981\u4f20\u5165\u4e00\u4e2a",(0,o.kt)("inlineCode",{parentName:"li"},"executor"),"\u6267\u884c\u5668\uff0c\u9ed8\u8ba4\u4f1a\u7acb\u5373\u6267\u884c\u3002"),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"promise"),"\u6709\u5185\u90e8\u4f1a\u63d0\u4f9b\u4e24\u4e2a\u65b9\u6cd5(\u975e\u539f\u578b\u5bf9\u8c61\u4e0a)\uff0c\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u4f1a\u4f20\u7ed9",(0,o.kt)("inlineCode",{parentName:"li"},"executor"),"\u6267\u884c\u5668\u65b9\u6cd5,\u53ef\u4ee5\u66f4\u6539",(0,o.kt)("inlineCode",{parentName:"li"},"promise"),"\u7684\u72b6\u6001\u3002"),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"Promise"),"\u6709\u4e09\u4e2a\u72b6\u6001\uff1a",(0,o.kt)("inlineCode",{parentName:"li"},"pending"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"fulfilled")," \u6216 ",(0,o.kt)("inlineCode",{parentName:"li"},"rejected"),"\uff0c\u4e00\u4e2a",(0,o.kt)("inlineCode",{parentName:"li"},"Promise"),"\u5fc5\u987b\u5904\u5728\u5176\u4e2d\u4e4b\u4e00\u7684\u72b6\u6001"),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"Promise"),"\u53ea\u4f1a\u4ece\u7b49\u5f85\u53d8\u4e3a\u6210\u529f\u6216\u8005\u4ece\u7b49\u5f85\u53d8\u4e3a\u5931\u8d25\uff0c\u4e14\u53d8\u5316\u5b8c\u6210\u540e\uff0c\u4e0d\u5141\u8bb8\u518d\u6539\u53d8\u72b6\u6001\u3002"),(0,o.kt)("li",{parentName:"ol"},"\u6bcf\u4e2a",(0,o.kt)("inlineCode",{parentName:"li"},"promise"),"\u5b9e\u4f8b\u4e0a\u90fd\u8981\u6709\u4e00\u4e2a",(0,o.kt)("inlineCode",{parentName:"li"},"then"),"\u65b9\u6cd5\uff0c \u5176\u63a5\u6536\u4e24\u4e2a\u53ef\u9009\u53c2\u6570\uff0c",(0,o.kt)("inlineCode",{parentName:"li"},"onFulfilled")," \u548c ",(0,o.kt)("inlineCode",{parentName:"li"},"onRejected"),"\uff0c\u5206\u522b\u662f\u6210\u529f\u548c\u5931\u8d25\u7684\u56de\u8c03")),(0,o.kt)("h3",{id:"\u5b9e\u73b0then\u548ccatch"},"\u5b9e\u73b0then\u548ccatch"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"\u5148\u5199\u4e2a\u6700\u521d\u7248\u672c\uff0c\u5b9e\u73b0")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u56de\u8c03\u51fd\u6570\u5ef6\u8fdf\u7ed1\u5b9a"),(0,o.kt)("li",{parentName:"ul"},"\u652f\u6301\u591a\u6b21\u7ed1\u5b9a\u56de\u8c03\u51fd\u6570")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// \u5b9a\u4e49\u4e09\u79cd\u72b6\u6001\nconst PENDING = "pending";\nconst RESOLVE = "resolve";\nconst REJECTED = "rejected";\n\nclass MyPromise {\n  constructor(exector) {\n    this.status = PENDING;\n    this.value = undefined;\n    this.reason = undefined;\n    this.onFulfilledCbs = [];\n    this.onRejectedCbs = [];\n\n    const resolve = (value) => {\n      if (this.status !== PENDING) { // \u53ea\u5141\u8bb8\u72b6\u6001\u7531\u7b49\u5f85\u53d8\u4e3a\u6210\u529f\u6216\u5931\u8d25\uff0c\u5e76\u4e14\u4e0d\u5141\u8bb8\u591a\u6b21\u8c03\u7528\n        return;\n      }\n      setTimeout(() => { // js\u4ee3\u7801\u672c\u8eab\u65e0\u6cd5\u8bbe\u7f6e\u5fae\u4efb\u52a1\uff0c\u8fd9\u91cc\u4f7f\u7528\u5b8f\u4efb\u52a1\u6765\u5b9e\u73b0\u5f02\u6b65\u64cd\u4f5c\n        this.value = value; // \u5b58\u50a8\u6267\u884c\u6210\u529f\u7684\u7ed3\u679c\n        this.status = RESOLVE; // \u8bbe\u7f6e\u72b6\u6001\u4e3a\u6210\u529f\n        this.onFulfilledCbs.forEach((cb) => { // \u987a\u6b21\u6267\u884c\u5f53\u524d\u5b58\u50a8\u7684\u6240\u6709\u6210\u529f\u7684\u56de\u8c03\u51fd\u6570\n          cb(this.value);\n        });\n      });\n    };\n\n    const rejected = (reason) => {\n      if (this.status !== PENDING) { // \u53ea\u5141\u8bb8\u72b6\u6001\u7531\u7b49\u5f85\u53d8\u4e3a\u6210\u529f\u6216\u5931\u8d25\uff0c\u5e76\u4e14\u4e0d\u5141\u8bb8\u591a\u6b21\u8c03\u7528\n        return;\n      }\n      setTimeout(() => {\n        this.reason = reason;\n        this.status = REJECTED;\n        this.onRejectedCbs.forEach((cb) => {\n          cb(reason);\n        });\n      });\n    };\n    exector(resolve, rejected);\n  }\n\n  then = (onFulfilled, onRejected) => {\n    if (this.status === PENDING) { // \u5982\u679c\u72b6\u6001\u4e3a\u7b49\u5f85\uff0c\u5219\u5b58\u50a8\u6210\u529f\u53ca\u5931\u8d25\u7684\u56de\u8c03\n      this.onFulfilledCbs.push(onFulfilled);\n      this.onRejectedCbs.push(onRejected);\n    } else if (this.status === RESOLVE) { // \u5426\u5219\uff0c\u76f4\u63a5\u6267\u884c\u5bf9\u5e94\u56de\u8c03\n      onFulfilled(this.value);\n    } else {\n      onRejected(this.reason);\n    }\n    return this;\n  };\n}\n')),(0,o.kt)("p",null,"\u6267\u884c\u4e00\u4e0b\u8bd5\u8bd5"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let readFilePromise = (filename) => {\n  return new MyPromise((resolve, reject) => {\n    setTimeout(() => {\n      resolve(filename);\n    }, 1000);\n  });\n};\n\nconst p1 = readFilePromise(\"./001.txt\");\n\np1.then((data) => {\n  console.log('\u7b2c\u4e00\u6b21\u56de\u8c03' + data.toString());\n});\n\np1.then((data) => {\n  console.log('\u7b2c\u4e8c\u6b21\u56de\u8c03' + data.toString());\n});\n\np1.then((data) => {\n  console.log('\u7b2c\u4e09\u6b21\u56de\u8c03' + data.toString());\n});\n\n// \u6253\u5370\u7ed3\u679c\n\u7b2c\u4e00\u6b21\u56de\u8c03./001.txt\n\u7b2c\u4e8c\u6b21\u56de\u8c03./001.txt\n\u7b2c\u4e09\u6b21\u56de\u8c03./001.txt\n\n")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"\u7b2c\u4e8c\u6b65\uff0c\u589e\u52a0\u94fe\u5f0f\u8c03\u7528\u529f\u80fd\u3002")),(0,o.kt)("p",null,"\u5728\u6700\u521d\u7684\u4f8b\u5b50\u4e2d\uff0c\u6bcf\u4e2aloadImg\u51fd\u6570\u5728\u6267\u884c\u5b8c\u540e\uff0c\u90fd\u4f1a\u8fd4\u56de\u4e00\u4e2aPromise\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"}," function loadImg(src){\n     const img = new Img();\n      img.src = src \n      return new Promise((resolve, reject)=>{\n          img.onload=()=>{resolve('success '+ src)}\n          img.onerror=()=>{reject(new Error('failed to load '+src ))  }\n      })\n  }\n")),(0,o.kt)("p",null,"\u8fd9\u6837\uff0c\u5728\u94fe\u5f0f\u8c03\u7528\u4e2d\uff0c\u6bcf\u4e00\u4e2athen\u65b9\u6cd5\u91cc\u7684\u51fd\u6570\uff0c\u90fd\u4f1a\u5728\u4e0a\u4e00\u4e2athen\u65b9\u6cd5\u6267\u884c\u5b8c\u6210\u540e\u6267\u884c\u3002\u4e5f\u5c31\u610f\u5473\u7740\uff0cthen\u65b9\u6cd5\u5728\u6267\u884c\u5b8c\u6210\u65f6\uff0c\u5fc5\u987b\u8fd4\u56de\u4e00\u4e2apromise\u5bf9\u8c61\uff0c\u4fdd\u8bc1\u4e0b\u4e00\u4e2a",(0,o.kt)("inlineCode",{parentName:"p"},".then"),"\u53ef\u4ee5\u88ab\u6b63\u786e\u6267\u884c\u3002"),(0,o.kt)("p",null,"\u800c\u5728\u6211\u4eec\u5b9e\u73b0\u7684\u4ee3\u7801\u4e2d\uff0cthen\u65b9\u6cd5\u8fd4\u56de\u4e86\u81ea\u5df1"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"}," then = (onFulfilled, onRejected) => {\n    // ...\n    // ...\n    return this;\n  };\n")),(0,o.kt)("p",null,"\u8fd9\u4e48\u505a\u4fdd\u8bc1\u4e86\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u94fe\u5f0f\u8c03\u7528\uff0c\u4f46\u662f\u8fd9\u79cd\u94fe\u5f0f\u8c03\u7528\u672c\u8d28\u4e0a\u5c31\u662f",(0,o.kt)("strong",{parentName:"p"},"\u591a\u6b21\u7ed1\u5b9a\u56de\u8c03\u51fd\u6570"),"\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const p1 = readFilePromise(\"./001.txt\");\n\np1.then((data) => {\n  console.log('\u7b2c\u4e00\u6b21\u56de\u8c03' + data.toString());\n}).then((data) => {\n  console.log('\u7b2c\u4e8c\u6b21\u56de\u8c03' + data.toString());\n}).then((data) => {\n  console.log('\u7b2c\u4e09\u6b21\u56de\u8c03' + data.toString());\n});\n\n// \u6253\u5370\u7ed3\u679c\n\u7b2c\u4e00\u6b21\u56de\u8c03./001.txt\n\u7b2c\u4e8c\u6b21\u56de\u8c03./001.txt\n\u7b2c\u4e09\u6b21\u56de\u8c03./001.txt\n")),(0,o.kt)("p",null,"\u5bf9\u6d4b\u8bd5\u4ee3\u7801\u505a\u4e0b\u53d8\u66f4\uff0c\u6bcf\u4e2a",(0,o.kt)("inlineCode",{parentName:"p"},"then"),"\u51fd\u6570\u5728\u6267\u884c\u5b8c\u6210\u540e\uff0c\u8fd4\u56de\u4e86\u4e0b\u4e00\u6b21\u7684\u8981\u6267\u884c\u64cd\u4f5c\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"Promise"),"\u5bf9\u8c61\u3002\u7ed3\u679c\u5982\u4e0b\u6240\u793a\uff0c\u8fd4\u56de\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"Promise"),"\u5bf9\u8c61\u88ab\u629b\u5f03\u4e86\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'const p1 = readFilePromise("./001.txt");\n\np1.then((data) => {\n  console.log("\u7b2c\u4e00\u6b21\u56de\u8c03" + data.toString());\n  return readFilePromise("./002.txt");\n})\n  .then((data) => {\n    console.log("\u7b2c\u4e8c\u6b21\u56de\u8c03" + data.toString());\n    return readFilePromise("./003.txt");\n  })\n  .then((data) => {\n    console.log("\u7b2c\u4e09\u6b21\u56de\u8c03" + data.toString());\n    console.log("\u8bfb\u53d6003\u6210\u529f", data);\n  });\n\n// \u6253\u5370\u7ed3\u679c\n\u7b2c\u4e00\u6b21\u56de\u8c03./001.txt\n\u7b2c\u4e8c\u6b21\u56de\u8c03./001.txt\n\u7b2c\u4e09\u6b21\u56de\u8c03./001.txt\n')),(0,o.kt)("p",null,"\u5173\u4e8e",(0,o.kt)("inlineCode",{parentName:"p"},"Promsie"),"\u96be\u70b9\u5c31\u5728\u4e8e",(0,o.kt)("inlineCode",{parentName:"p"},"then"),"\u7684\u8fd4\u56de\u503c\u662f",(0,o.kt)("inlineCode",{parentName:"p"},"Promise\u5bf9\u8c61"),"\u7684\u60c5\u51b5\u3002"),(0,o.kt)("p",null,"\u5728",(0,o.kt)("inlineCode",{parentName:"p"},"then"),"\u65b9\u6cd5\u7684\u5185\u90e8\u672c\u8d28\u4e0a\u662f\u8fd4\u56de\u4e86\u4e00\u4e2a\u65b0\u7684Promsie\u5bf9\u8c61\uff0c\u6211\u4eec\u5c06\u5176\u79f0\u4e4b\u4e3a",(0,o.kt)("inlineCode",{parentName:"p"},"thenPromsie"),"\uff0c\u4e4b\u540e\u9700\u8981\u901a\u8fc7\u8c03\u7528\u8fd9\u4e2a",(0,o.kt)("inlineCode",{parentName:"p"},"thenPromsie"),"\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"reslove"),"\u65b9\u6cd5\uff0c\u6765\u89e6\u53d1\u6267\u884c",(0,o.kt)("inlineCode",{parentName:"p"},"\u4e0b\u4e00\u4e2athen\u4e2d\u7684\u56de\u8c03\u51fd\u6570"),"\u3002"),(0,o.kt)("p",null,"\u5982\u679cthen\u5185\u90e8\u8fd4\u56de\u503c\u662f\u4e00\u4e2a\u503c\u7684\u60c5\u51b5\u5f88\u597d\u89e3\u51b3\uff0c\u76f4\u63a5\u8c03\u7528",(0,o.kt)("inlineCode",{parentName:"p"},"thenPromsie"),"\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"resolve"),"\u65b9\u6cd5\u4fbf\u597d\uff0c\u5982\u679c\u8fd4\u56de\u503c\u662f\u4e00\u4e2a",(0,o.kt)("inlineCode",{parentName:"p"},"Promsie"),"\u5bf9\u8c61\uff0c\u6211\u4eec\u8981\u6839\u636e\u8fd9\u4e2a",(0,o.kt)("inlineCode",{parentName:"p"},"Promise"),"\u5bf9\u8c61\u662f\u5426\u88ab",(0,o.kt)("inlineCode",{parentName:"p"},"resolve"),"\u800c\u51b3\u5b9a",(0,o.kt)("inlineCode",{parentName:"p"},"thenPromsie"),"\u662f\u5426\u88ab",(0,o.kt)("inlineCode",{parentName:"p"},"resolve"),"\uff0c\u7ee7\u800c\u51b3\u5b9a\u662f\u5426\u6267\u884c\u4e0b\u4e00\u4e2athen\u4e2d\u7684\u56de\u8c03\u51fd\u6570\u3002"),(0,o.kt)("p",null,"\u5bf9",(0,o.kt)("inlineCode",{parentName:"p"},"then"),"\u65b9\u6cd5\u505a\u4e0b\u6539\u52a8\uff0c\u4ee5",(0,o.kt)("inlineCode",{parentName:"p"},"PENDING"),"\u72b6\u6001\u4e3a\u4f8b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"}," if (this.status === PENDING) {\n    // \u81ea\u884c\u6784\u9020\u4e00\u4e2aPromise\uff0c\u4fdd\u8bc1then\u7684\u8fd4\u56de\u7ed3\u679c\u6c38\u8fdc\u4e3a\u4e00\u4e2aPromise\u5bf9\u8c61\n      let promise2 = new MyPromise((resolve, rejected) => { \n        this.onFulfilledCbs.push((value) => {\n          try {\n            const x = onFulfilled(value); // \u83b7\u5f97\u56de\u8c03\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff0c\u5e76\u8fdb\u4e00\u6b65\u5904\u7406\n            // \u5982\u679c\u56de\u8c03\u51fd\u6570\u8fd4\u56de\u7684promise\u548cthen\u65b9\u6cd5\u4e2d\u6784\u9020\u7684promise\u662f\u540c\u4e00\u4e2a\u5bf9\u8c61\uff0c\u629b\u5f02\u5e38\uff0c\u5426\u5219\u4f1a\u9677\u5165\u6b7b\u5faa\u73af\n            if (x === promise2) { \n                        return reject(new TypeError('[TypeError: Chaining cycle detected for promise #<Promise>]'));\n                     }\n            if (x instanceof MyPromise) { // \u5982\u679c\u56de\u8c03\u51fd\u6570\u7684\u7ed3\u679c\u662fPromise\uff0c\u6267\u884c\u5176then\u65b9\u6cd5\uff0c\u5e76\u5c06resolve, rejected\u4f20\u5165\uff0c\n                x.then(resolve, rejected); \n            } else {\n                resolve(x); // \u8fd4\u56de\u503c\u662f\u4e00\u4e2a\u503c\uff0c\u76f4\u63a5resolve\u5373\u53ef\n            }\n          } catch (error) {\n            rejected(error);\n          }\n        });\n        this.onRejectedCbs.push((reason) => {\n          try {\n            const x = onRejected(reason);\n            // \u5982\u679c\u56de\u8c03\u51fd\u6570\u8fd4\u56de\u7684promise\u548cthen\u65b9\u6cd5\u4e2d\u6784\u9020\u7684promise\u662f\u540c\u4e00\u4e2a\u5bf9\u8c61\uff0c\u629b\u5f02\u5e38\uff0c\u5426\u5219\u4f1a\u9677\u5165\u6b7b\u5faa\u73af\n            if (x === promise2) { \n                        return reject(new TypeError('[TypeError: Chaining cycle detected for promise #<Promise>]'));\n                     }\n            if (x instanceof MyPromise) { // \u5982\u679c\u56de\u8c03\u51fd\u6570\u7684\u7ed3\u679c\u662fPromise\uff0c\u6267\u884c\u5176then\u65b9\u6cd5\uff0c\u5e76\u5c06resolve, rejected\u4f20\u5165\uff0c\n                x.then(resolve, rejected); \n            } else {\n                resolve(x); // \u8fd4\u56de\u503c\u662f\u4e00\u4e2a\u503c\uff0c\u76f4\u63a5resolve\u5373\u53ef\n            }\n          } catch (error) {\n            rejected(error);\n          }\n        });\n      });\n      return promise2;\n")),(0,o.kt)("p",null,"\u63d0\u53d6\u5904\u7406",(0,o.kt)("inlineCode",{parentName:"p"},"onFulfilled/onRejected"),"\u8fd4\u56de\u503c\u7684\u903b\u8f91"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"}," resolvePromise = (promise2, x, resolve, rejected) => {\n    if (x === promise2) { // \u5982\u679c\u56de\u8c03\u51fd\u6570\u8fd4\u56de\u7684promise\u548cthen\u65b9\u6cd5\u4e2d\u6784\u9020\u7684promise\u662f\u540c\u4e00\u4e2a\u5bf9\u8c61\uff0c\u629b\u5f02\u5e38\uff0c\u5426\u5219\u4f1a\u9677\u5165\u6b7b\u5faa\u73af\n        return reject(new TypeError('[TypeError: Chaining cycle detected for promise #<Promise>]'));\n    }\n    if (x instanceof MyPromise) { // \u5982\u679c\u56de\u8c03\u51fd\u6570\u7684\u7ed3\u679c\u662fPromise\uff0c\u6267\u884c\u5176then\u65b9\u6cd5\uff0c\u5e76\u5c06resolve, rejected\u4f20\u5165\uff0c\n        x.then(resolve, rejected); \n    } else {\n        resolve(x);\n    }\n}\n")),(0,o.kt)("p",null,"\u5f53\u524d",(0,o.kt)("inlineCode",{parentName:"p"},"then"),"\u51fd\u6570\u4ee3\u7801\u5982\u4e0b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"  then = (onFulfilled, onRejected) => {\n\n    if (this.status === PENDING) {\n    // \u81ea\u884c\u6784\u9020\u4e00\u4e2aPromise\uff0c\u4fdd\u8bc1then\u7684\u8fd4\u56de\u7ed3\u679c\u6c38\u8fdc\u4e3a\u4e00\u4e2aPromise\u5bf9\u8c61\n      let promise2 = new MyPromise((resolve, rejected) => { \n        this.onFulfilledCbs.push((value) => {\n          try {\n            const x = onFulfilled(value); // \u83b7\u5f97\u56de\u8c03\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff0c\u5e76\u8fdb\u4e00\u6b65\u5904\u7406\n            this.resolvePromise(promise2, x, resolve, rejected);\n          } catch (error) {\n            rejected(error); // \u6709\u5f02\u5e38\u5219rejected\n          }\n        });\n        this.onRejectedCbs.push((reason) => {\n          try {\n            const x = onRejected(reason);\n            this.resolvePromise(promise2, x, resolve, rejected);\n          } catch (error) {\n            rejected(error);\n          }\n        });\n      });\n      return promise2;\n    } else if (this.status === RESOLVE) {\n      let promise2 = new MyPromise((resolve, rejected) => {\n        try {\n          const x = onFulfilled(this.value);\n          this.resolvePromise(promise2, x, resolve, rejected);\n        } catch (error) {\n          rejected(error);\n        }\n      });\n      return promise2;\n    } else {\n      let promise2 = new MyPromise((resolve, rejected) => {\n        try {\n          const x = onRejected(this.reason);\n          this.resolvePromise(promise2, x, resolve, rejected);\n        } catch (error) {\n          rejected(error);\n        }\n      });\n      return promise2;\n    }\n  };\n")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"\u4fee\u590d\u4e0b\u903b\u8f91\u6f0f\u6d1e")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u5904\u7406",(0,o.kt)("inlineCode",{parentName:"li"},"then"),"\u4e2d\u4e24\u4e2a\u53c2\u6570\u4e3a\u7a7a\u7684\u60c5\u51b5")),(0,o.kt)("p",null,"\u5bf9\u53c2\u6570\u4e0d\u4f20\u7684\u60c5\u51b5\u505a\u5224\u65ad:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : value => value; // \u6210\u529f\u56de\u8c03\u9ed8\u8ba4\u8fd4\u56de\u5f53\u524d\u6210\u529f\u7684\u7ed3\u679c\nonRejected = typeof onRejected === 'function' ? onRejected : error => { throw error }; // \u5931\u8d25\u56de\u8c03\u76f4\u63a5\u629b\u5f02\u5e38\n")),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},"\u5b9e\u73b0",(0,o.kt)("inlineCode",{parentName:"li"},"catch"),"\u65b9\u6cd5")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"catch"),"\u65b9\u6cd5\u5176\u5b9e\u5c31\u662f\u6ca1\u6709\u6210\u529f\u56de\u8c03\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"then"),"\u65b9\u6cd5\u3002\u5373"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"catch = (onRejected) => {\n  return this.then(null, onRejected);\n}\n")),(0,o.kt)("p",null,"\u4e00\u65e6\u5176\u4e2d\u6709\u4e00\u4e2a",(0,o.kt)("inlineCode",{parentName:"p"},"PENDING"),"\u72b6\u6001\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"Promise")," \u51fa\u73b0\u9519\u8bef\u540e\u72b6\u6001\u5fc5\u7136\u4f1a\u53d8\u4e3a\u5931\u8d25, \u7136\u540e\u6267\u884c ",(0,o.kt)("inlineCode",{parentName:"p"},"onRejected"),"\u51fd\u6570\uff0c\u800c\u5728\u94fe\u5f0f\u8c03\u7528\u4e2d\uff0c\u5982\u679c",(0,o.kt)("inlineCode",{parentName:"p"},"then"),"\u65b9\u6cd5\u6ca1\u6709\u4f20\u5165\u5931\u8d25\u56de\u8c03\uff0c\u5219\u4f1a\u7531\u9ed8\u8ba4\u7684\u51fd\u6570\u629b\u51fa\u5f02\u5e38\uff0c\u628a\u65b0\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"Promise")," \u72b6\u6001\u53d8\u4e3a\u5931\u8d25\uff0c\u65b0\u7684 Promise \u72b6\u6001\u53d8\u4e3a\u5931\u8d25\u540e\u53c8\u4f1a\u6267\u884c",(0,o.kt)("inlineCode",{parentName:"p"},"onRejected"),"......\u5c31\u8fd9\u6837\u4e00\u76f4\u629b\u4e0b\u53bb\uff0c\u76f4\u5230\u7528",(0,o.kt)("inlineCode",{parentName:"p"},"catch")," \u6355\u83b7\u5230\u8fd9\u4e2a\u9519\u8bef\uff0c\u624d\u505c\u6b62\u5f80\u4e0b\u629b\u3002\n\u8fd9\u5c31\u662f Promise \u7684\u9519\u8bef\u5192\u6ce1\u673a\u5236\u3002"),(0,o.kt)("h3",{id:"\u5b9e\u73b0resolve"},"\u5b9e\u73b0Resolve"),(0,o.kt)("p",null,"\u521b\u5efa\u4e00\u4e2a\u6210\u529f\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"promise")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"static resolve = (param) => {\n      if(param instanceof MyPromise){\n          return param;\n      }\n      return new MyPromise((resolve, reject) => {\n                resolve(param);\n            })\n};\n")),(0,o.kt)("h3",{id:"\u5b9e\u73b0reject"},"\u5b9e\u73b0Reject"),(0,o.kt)("p",null,"\u4f20\u5165\u7684\u53c2\u6570\u4f1a\u4f5c\u4e3a\u4e00\u4e2a ",(0,o.kt)("inlineCode",{parentName:"p"},"reason")," \u539f\u5c01\u4e0d\u52a8\u5730\u5f80\u4e0b\u4f20"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"  static reject = (reason) => {\n    return new MyPromise((resolve, reject) => {\n      reject(reason);\n    });\n  };\n")),(0,o.kt)("h3",{id:"\u5b9e\u73b0finall"},"\u5b9e\u73b0Finall"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"finally()"),"\u65b9\u6cd5\u7528\u4e8e\u6307\u5b9a\u4e0d\u7ba1 ",(0,o.kt)("inlineCode",{parentName:"p"},"Promise")," \u5bf9\u8c61\u6700\u540e\u72b6\u6001\u5982\u4f55\uff0c\u90fd\u4f1a\u6267\u884c\u7684\u64cd\u4f5c\u3002\u8be5\u65b9\u6cd5\u4f1a\u5c06\u503c\u539f\u5c01\u4e0d\u52a8\u7684\u4f20\u9012\u4e0b\u53bb\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"finally = (callback) => {\n    return this.then(value => {\n      return MyPromise.resolve(callback()).then(() => {\n        return value;\n      });\n    }, error => {\n      return MyPromise.resolve(callback()).then(() => {\n        throw error;\n      });\n    });\n  }\n")),(0,o.kt)("h3",{id:"\u5b9e\u73b0all"},"\u5b9e\u73b0all"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u53c2\u6570\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u6570\u7ec4\u5185\u662f\u4e00\u4e2a\u4e00\u4e2a\u7684promise\uff0c\u8fd9\u4e9b\u6570\u7ec4\u5185\u7684promise\u4f1a\u5e76\u884c\u6267\u884c\u3002"),(0,o.kt)("li",{parentName:"ul"},"\u6700\u7ec8\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684promise"),(0,o.kt)("li",{parentName:"ul"},"\u53ea\u8981\u6709\u4e00\u4e2apromise\u72b6\u6001\u53d8\u4e3a",(0,o.kt)("inlineCode",{parentName:"li"},"rejected"),"\uff0c\u90a3\u4e48\u6700\u7ec8\u8fd4\u56de\u7684\u8fd9\u4e2a\u65b0\u7684pomise\u7684\u72b6\u6001\u5c31\u662f",(0,o.kt)("inlineCode",{parentName:"li"},"rejected"),"\u3002"),(0,o.kt)("li",{parentName:"ul"},"\u5f53\u6240\u6709\u7684promise\u90fd\u53d8\u4e3a",(0,o.kt)("inlineCode",{parentName:"li"},"fulfilled"),"\uff0c\u6700\u7ec8\u8fd4\u56de\u7684\u8fd9\u4e2a\u65b0\u7684promise\u7684\u72b6\u6001\u624d\u4f1a\u53d8\u4e3a",(0,o.kt)("inlineCode",{parentName:"li"},"fulfilled"),", \u5e76\u4e14\u8fd4\u56de\u7684\u7ed3\u679c\u662f\u4e00\u4e2a\u6570\u7ec4\u3002")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"  static all = (promises) => {\n    return new MyPromise((resolve, reject) => {\n      let result = [];\n      let count = 0;\n      let len = promises.length;\n      if (len === 0) {\n        resolve(result);\n        return;\n      }\n      promises.forEach((promise, index) => {\n        MyPromise.resolve(promise[index]) // promise[index]\u53ef\u80fd\u4e0d\u662f\u4e00\u4e2apromise\n          .then((data) => {\n            result[index] = data;\n            count++;\n            if (count === len) {\n              resolve(result);\n            }\n          })\n          .catch((err) => {\n            reject(err);\n          });\n      });\n    });\n  };\n")),(0,o.kt)("h3",{id:"\u5b9e\u73b0race"},"\u5b9e\u73b0race"),(0,o.kt)("p",null,"\u53ea\u8981\u6709\u4e00\u4e2a promise \u6267\u884c\u5b8c\uff0c\u76f4\u63a5 resolve \u5e76\u505c\u6b62\u6267\u884c\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"  static race = (promises) => {\n      return new MyPromise((resolve, reject) => {\n        let len = promises.length;\n        if (len === 0) {\n          resolve(result);\n          return;\n        }\n        promises.forEach((promise, index) => {\n            MyPromise.resolve(promise[index]) // promise[index]\u53ef\u80fd\u4e0d\u662f\u4e00\u4e2apromise\n              .then((data) => {\n                resolve(data);\n                return;\n              })\n              .catch((err) => {\n                reject(err);\n              });\n          });\n      })\n  }\n}\n")),(0,o.kt)("h2",{id:"\u5173\u8054\u95ee\u9898"},"\u5173\u8054\u95ee\u9898"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u5b9e\u73b0Ajax\u5e76\u53d1\u8bf7\u6c42\u63a7\u5236"),"  "),(0,o.kt)("p",null,"\u89e3\u51b3\u65b9\u6848\uff1a\u901a\u8fc7while\u5faa\u73af\u63a7\u5236\u6700\u5927\u5e76\u53d1\u6570\uff0c\u5229\u7528\u9012\u5f52\u4f7f\u4efb\u52a1\u6301\u7eed\u6267\u884c\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"function multiRequest(urls = [], maxNum) {\n  // \u8bf7\u6c42\u603b\u6570\u91cf\n  const len = urls.length;\n  // \u6839\u636e\u8bf7\u6c42\u6570\u91cf\u521b\u5efa\u4e00\u4e2a\u6570\u7ec4\u6765\u4fdd\u5b58\u8bf7\u6c42\u7684\u7ed3\u679c\n  const result = new Array(len).fill(false);\n  let index = 0;\n  function next() {\n    new Promise((resolve, reject) => {\n      const current = index;\n      const url = urls[index];\n      index++;\n      // \u6a21\u62df\u7f51\u7edc\u8bf7\u6c42\n      setTimeout(()=>{\n        result[current] = url;\n        resolve(url)\n      }, 1000);\n    }).then((data) => {\n      console.log('\u5b8c\u6210\u4efb\u52a1->', data);\n      if (index < len) {\n        // \u5229\u7528\u9012\u5f52\u63a7\u5236\u4efb\u52a1\u6301\u7eed\u6267\u884c\n        next();\n      }\n    });\n  }\n\n  while (maxNum) {\n    next();\n    maxNum -= 1;\n  }\n}\nmultiRequest([1,2,3,4,5],2)\n")),(0,o.kt)("h2",{id:"\u8865\u5145\u77e5\u8bc6"},"\u8865\u5145\u77e5\u8bc6"),(0,o.kt)("h3",{id:"promisea-\u89c4\u8303"},"Promise/A+ \u89c4\u8303"),(0,o.kt)("p",null,"\u5728\u4e0a\u4e00\u8282\u5f00\u59cb\uff0c\u4e3a\u4e86\u89c4\u8303\u4ee3\u7801\u7684\u601d\u8def\uff0c\u7b80\u5355\u4ecb\u7ecd\u4e86Promise/A+ \u89c4\u8303\u4e3b\u4f53\u7ed3\u6784\uff0c\u5f88\u591a\u7ec6\u8282\u5e76\u6ca1\u6709\u5c55\u5f00\uff0c\u672c\u6587\u4e5f\u4e0d\u8ba1\u5212\u5bf9\u89c4\u8303\u8fdb\u884c\u8be6\u7ec6\u4ecb\u7ecd\uff0c\u8fd9\u91cc\u9644\u4e0a"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u767e\u5ea6\u7684\u4e00\u7bc7",(0,o.kt)("a",{parentName:"li",href:"https://zhuanlan.zhihu.com/p/143204897"},"Promise/A+ \u89c4\u8303"),"\u6587\u7ae0\u3002"),(0,o.kt)("li",{parentName:"ul"},"\u82f1\u6587\u539f\u6587\u5730\u5740\uff1a",(0,o.kt)("a",{parentName:"li",href:"http://promisesaplus.com/"},"http://promisesaplus.com")),(0,o.kt)("li",{parentName:"ul"},"\u82e5\u8981\u4e86\u89e3\u6587\u4e2d\u6bcf\u4e00\u6761\u89c4\u5219\uff0c\u5219\u53c2\u9605\u5176\u6d4b\u8bd5\u4ed3\u5e93\uff1a",(0,o.kt)("a",{parentName:"li",href:"https://github.com/promises-aplus/promises-tests/tree/master/lib/tests"},"https://github.com/promises-aplus/promises-tests/tree/master/lib/tests"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Promise\u89e3\u6790\u8fc7\u7a0b"),"\n\u8fd9\u91cc\u989d\u5916\u8bf4\u660e\u4e00\u4e0b\uff0c\u4e3a\u4e86\u7b80\u5316\u4ee3\u7801\uff0c\u6211\u4eec\u5047\u8bbe\u4ee3\u7801\u6267\u884c\u73af\u5883\u53ea\u6709\u6211\u4eec\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"MyPromise"),"\uff0c\u56e0\u6b64\uff0c\u5728\u4e0a\u8ff0\u4ee3\u7801\u4e2d\uff0c\u6ca1\u6709\u5bf9\u7b26\u5408",(0,o.kt)("inlineCode",{parentName:"p"},"Promise"),"\u89c4\u8303\u7684\u5176\u4ed6\u5b9e\u73b0\u505a\u5904\u7406\u3002\u82e5\u60f3\u5b9e\u73b0\uff0c\u53ef\u79fb\u6b65\u53c2\u8003\u6587\u68633\u3002"),(0,o.kt)("h3",{id:"\u8bbe\u8ba1\u6a21\u5f0f"},"\u8bbe\u8ba1\u6a21\u5f0f"),(0,o.kt)("p",null,"Promise\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u7ee7\u627f\u4e86\u89c2\u5bdf\u8005\u548c\u53d1\u5e03-\u8ba2\u9605\u8bbe\u8ba1\u6a21\u5f0f\u7684\u601d\u60f3,\u8fd9\u91cc\u76f4\u63a5\u63a8\u8350\u4e00\u7bc7\u535a\u6587",(0,o.kt)("a",{parentName:"p",href:"https://blog.csdn.net/daydream13580130043/article/details/89741767"},"\u4ece\u8bbe\u8ba1\u6a21\u5f0f\u89d2\u5ea6\u5206\u6790Promise\uff1a\u624b\u5199Promise\u5e76\u4e0d\u96be")),(0,o.kt)("h3",{id:"promise\u548casync\u7684\u5dee\u5f02\u70b9"},"Promise\u548casync\u7684\u5dee\u5f02\u70b9"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u8be5\u77e5\u8bc6\u70b9\u51fa\u81ea\u53c2\u8003\u6587\u68632")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"async"),"\u662f",(0,o.kt)("strong",{parentName:"p"},"Generator"),"\u51fd\u6570\u7684\u8bed\u6cd5\u7cd6\uff0c\u4e0d\u540c\u7684\u662fGenerator\u51fd\u6570\u662f",(0,o.kt)("strong",{parentName:"p"},"\u624b\u52a8\u8c03\u7528"),"\u7684\uff0c\u800casync\u51fd\u6570\u662fawait\u6267\u884c\u5b8c\u4e4b\u540e\u624d\u4f1a\u81ea\u52a8\u6267\u884c\u4e0b\u4e00\u4e2aawait\u524d\u9762\u7684\u8bed\u53e5\uff0c\u65e0\u8bbaawait\u524d\u9762\u662f\u5f02\u6b65\u65b9\u6cd5\u8fd8\u662f\u540c\u6b65\u65b9\u6cd5\u3002"),(0,o.kt)("p",null,"await\u540e\u9762\u53ef\u4ee5\u8ddf\u5f88\u591a\u503c\uff0c\u5982\u57fa\u672c\u6570\u636e\u7c7b\u578b\u3001\uff08\u5b57\u7b26\uff0c\u6570\u503c\uff0c\u5e03\u5c14\u7b49\u4f1a\u88ab\u81ea\u52a8\u8f6c\u6362\u4e3a",(0,o.kt)("strong",{parentName:"p"},"\u7acb\u5373resolved\u7684Promsie\u5bf9\u8c61"),"\uff09Promise\u5bf9\u8c61\u3002"),(0,o.kt)("p",null,"async\u5185\u90e8\u662f\u5f02\u6b65\u6267\u884c\u7684\uff0c\u65e0\u8bbaawait\u540e\u9762\u8ddf\u7684\u662f\u540c\u6b65\u4efb\u52a1\u8fd8\u662f\u5f02\u6b65\u4efb\u52a1\uff0c\u6700\u7ec8async\u51fd\u6570\u4f1a\u8fd4\u56de\u4e00\u4e2aPromise\u5bf9\u8c61\uff0c\u6240\u4ee5",(0,o.kt)("strong",{parentName:"p"},"async\u51fd\u6570\u53ef\u4ee5\u770b\u6210\u662f\u591a\u4e2a\u5f02\u6b65\u64cd\u4f5c\u5305\u88c5\u6210\u7684Promise\u5bf9\u8c61\uff0c","*","*async\u8ba9Promsie\u7684\u4f7f\u7528\u66f4\u987a\u6ed1\u3002","*","*")),(0,o.kt)("p",null,"\u5982\u679c\u6211\u4eec\u8981\u4e32\u884c\u53d1\u9001\u5f88\u591a\u8bf7\u6c42"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u4f7f\u7528Promise")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"function logInOrder(urls) {\n  // \u8fdc\u7a0b\u8bfb\u53d6\u6240\u6709URL\n  const textPromises = urls.map(url => {\n    return fetch(url).then(response => response.text());\n  });\n\n  // \u6309\u6b21\u5e8f\u8f93\u51fa\n  textPromises.reduce((chain, textPromise) => {\n    return chain.then(() => textPromise)\n      .then(text => console.log(text));\n  }, Promise.resolve());\n}\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u4f7f\u7528async")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"async function logInOrder(urls) {\n  for (const url of urls) {\n    const response = await fetch(url);\n    console.log(await response.text());\n  }\n}\n")),(0,o.kt)("p",null,"\u5982\u679c\u8981\u5e76\u884c\u53d1\u9001\u5f88\u591a\u8bf7\u6c42"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"async function logInOrder(urls) {\n  // \u5e76\u53d1\u8bfb\u53d6\u8fdc\u7a0bURL\n  const textPromises = urls.map(async url => {\n    const response = await fetch(url);\n    return response.text();\n  });\n\n  // \u6309\u6b21\u5e8f\u8f93\u51fa\n  for (const textPromise of textPromises) {\n    console.log(await textPromise);\n  }\n}\n")),(0,o.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u867d\u7136",(0,o.kt)("inlineCode",{parentName:"p"},"map"),"\u65b9\u6cd5\u7684\u53c2\u6570\u662f",(0,o.kt)("inlineCode",{parentName:"p"},"async"),"\u51fd\u6570\uff0c\u4f46\u5b83\u662f\u5e76\u53d1\u6267\u884c\u7684\uff0c\u56e0\u4e3a\u53ea\u6709",(0,o.kt)("inlineCode",{parentName:"p"},"async"),"\u51fd\u6570\u5185\u90e8\u662f\u7ee7\u53d1\u6267\u884c\uff0c\u5916\u90e8\u4e0d\u53d7\u5f71\u54cd\u3002\u540e\u9762\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"for..of"),"\u5faa\u73af\u5185\u90e8\u4f7f\u7528\u4e86",(0,o.kt)("inlineCode",{parentName:"p"},"await"),"\uff0c\u56e0\u6b64\u5b9e\u73b0\u4e86\u6309\u987a\u5e8f\u8f93\u51fa\u3002"),(0,o.kt)("h2",{id:"\u53c2\u8003\u6587\u6863"},"\u53c2\u8003\u6587\u6863"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"http://caibaojian.com/promise-a.html"},"\u7cbe\u8bfbJS\u7cfb\u5217\uff089b\uff09 Promise \u2014 \u56de\u8c03\u5730\u72f1\u3001Promise\u6784\u9020\u5668")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://juejin.cn/post/6918719482575880200"},"Promise\u9762\u8bd5\u7075\u9b42\u5341\u4e8c\u95ee")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://juejin.cn/post/6844904088963022856"},"Promise(1)-\u624b\u5199Promise"))),(0,o.kt)("h2",{id:"\u793a\u4f8b\u4ee3\u7801"},"\u793a\u4f8b\u4ee3\u7801"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'const PENDING = "pending";\nconst RESOLVE = "resolve";\nconst REJECTED = "rejected";\n\nclass MyPromise {\n  constructor(exector) {\n    this.status = PENDING;\n    this.value = undefined;\n    this.reason = undefined;\n    this.onFulfilledCbs = [];\n    this.onRejectedCbs = [];\n\n    const resolve = (value) => {\n      if (this.status !== PENDING) {\n        return;\n      }\n      setTimeout(() => {\n        this.value = value;\n        this.status = RESOLVE;\n        this.onFulfilledCbs.forEach((cb) => {\n          cb(this.value);\n        });\n      });\n    };\n\n    const rejected = (reason) => {\n      if (this.status !== PENDING) {\n        return;\n      }\n      setTimeout(() => {\n        this.reason = reason;\n        this.status = REJECTED;\n        this.onRejectedCbs.forEach((cb) => {\n          cb(reason);\n        });\n      });\n    };\n    exector(resolve, rejected);\n  }\n\n  resolvePromise = (promise2, x, resolve, rejected) => {\n    if (x === promise2) {\n      return reject(\n        new TypeError(\n          "[TypeError: Chaining cycle detected for promise #<Promise>]"\n        )\n      );\n    }\n    if (x instanceof MyPromise) {\n      x.then(resolve, rejected);\n    } else {\n      resolve(x);\n    }\n  };\n\n  then = (onFulfilled, onRejected) => {\n    onFulfilled =\n      typeof onFulfilled === "function" ? onFulfilled : (value) => value;\n    onRejected =\n      typeof onRejected === "function"\n        ? onRejected\n        : (error) => {\n            throw error;\n          };\n\n    if (this.status === PENDING) {\n      let promise2 = new MyPromise((resolve, rejected) => {\n        this.onFulfilledCbs.push((value) => {\n          try {\n            const x = onFulfilled(value);\n            this.resolvePromise(promise2, x, resolve, rejected);\n          } catch (error) {\n            rejected(error);\n          }\n        });\n        // console.log(\'-----\x3elist\', this.onRejectedCbs);\n        this.onRejectedCbs.push((reason) => {\n          try {\n            const x = onRejected(reason);\n            this.resolvePromise(promise2, x, resolve, rejected);\n          } catch (error) {\n            rejected(error);\n          }\n        });\n      });\n      return promise2;\n    } else if (this.status === RESOLVE) {\n      let promise2 = new MyPromise((resolve, rejected) => {\n        try {\n          const x = onFulfilled(this.value);\n          this.resolvePromise(promise2, x, resolve, rejected);\n        } catch (error) {\n          rejected(error);\n        }\n      });\n      return promise2;\n    } else {\n      let promise2 = new MyPromise((resolve, rejected) => {\n        try {\n          const x = onRejected(this.reason);\n          this.resolvePromise(promise2, x, resolve, rejected);\n        } catch (error) {\n          rejected(error);\n        }\n      });\n      return promise2;\n    }\n  };\n\n  catch = (onRejected) => {\n    return this.then(null, onRejected);\n  };\n\n  static resolve = (param) => {\n    if (param instanceof MyPromise) {\n      return param;\n    }\n    return new MyPromise((resolve, reject) => {\n      resolve(param);\n    });\n  };\n\n  static reject = (reason) => {\n    return new MyPromise((resolve, reject) => {\n      reject(reason);\n    });\n  };\n\n  finally = (callback) => {\n    return this.then(\n      (value) => {\n        return MyPromise.resolve(callback()).then(() => {\n          return value;\n        });\n      },\n      (error) => {\n        return MyPromise.resolve(callback()).then(() => {\n          throw error;\n        });\n      }\n    );\n  };\n\n  static all = (promises) => {\n    return new MyPromise((resolve, reject) => {\n      let result = [];\n      let count = 0;\n      let len = promises.length;\n      if (len === 0) {\n        resolve(result);\n        return;\n      }\n      promises.forEach((promise, index) => {\n        MyPromise.resolve(promise[index]) // promise[index]\u53ef\u80fd\u4e0d\u662f\u4e00\u4e2apromise\n          .then((data) => {\n            result[index] = data;\n            count++;\n            if (count === len) {\n              resolve(result);\n            }\n          })\n          .catch((err) => {\n            reject(err);\n          });\n      });\n    });\n  };\n\n  static race = (promises) => {\n      return new MyPromise((resolve, reject) => {\n        let len = promises.length;\n        if (len === 0) {\n          resolve(result);\n          return;\n        }\n        promises.forEach((promise, index) => {\n            MyPromise.resolve(promise[index]) // promise[index]\u53ef\u80fd\u4e0d\u662f\u4e00\u4e2apromise\n              .then((data) => {\n                resolve(data);\n                return;\n              })\n              .catch((err) => {\n                reject(err);\n              });\n          });\n      })\n  }\n}\n/******************************\u6d4b\u8bd5*****************************/\n\nlet readFilePromise = (filename) => {\n  return new MyPromise((resolve, reject) => {\n    setTimeout(() => {\n      if (filename === "./003.txt") {\n        reject("--------------\x3e" + filename);\n        return;\n      }\n      resolve(filename);\n    }, 1000);\n  });\n};\n// readFilePromise(\'./001.txt\').then(data => {\n//     console.log(data.toString());\n//     return readFilePromise(\'./002.txt\');\n// }).then(data => {\n//     console.log(data.toString());\n//     return readFilePromise(\'./003.txt\');\n// }).then(data => {\n//     console.log(\'\u8bfb\u53d6003\u6210\u529f\', data);\n// }).catch(error => {\n//     console.log(\'\u5931\u8d25\', error)\n// })\n\nconst p1 = readFilePromise("./001.txt");\n\nconst p2 = p1.then((data) => {\n  console.log(data.toString());\n  return readFilePromise("./002.txt");\n});\n\nconst p3 = p2.then((data) => {\n  console.log(data.toString());\n  return readFilePromise("./003.txt");\n});\n\nconst p4 = p3.then((data) => {\n  console.log("\u8bfb\u53d6003\u6210\u529f", data);\n});\n\nconst p5 = p3.catch((error) => {\n  console.log("\u5931\u8d25", error);\n});\n\n')))}u.isMDXComponent=!0}}]);